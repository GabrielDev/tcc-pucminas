<form [formGroup]="pedidoForm" (submit)="finalizar()">
<div class="header bg-gradient-danger pb-8 pt-5 pt-md-8">
    <div class="container-fluid">
      <div class="header-body">
        <div class="row align-items-center py-4">
          <div class="col-12">
            <div class="form-group">
              <label for="item" class="form-control-label text-white">Adicionar item</label>
              <p-autoComplete 
                id="item"
                [(ngModel)]="pedido.cliente" 
                [suggestions]="clientes" 
                (completeMethod)="buscarClientes($event)"
                [forceSelection]="true"
                aria-placeholder="Buscar produto ou serviço por nome ou código">
              </p-autoComplete>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Page content -->
  <div class="container-fluid mt--7">
    <!-- Table -->
    <div class="row">
      <div class="col-sm-8 col-12">
        <div class="card shadow">
          <div class="card-header border-0">
            <h3 class="mb-0">Pedidos</h3>
          </div>
          <div class="table-responsive">
            <table class="table align-items-center table-flush">
              <thead class="thead-light">
                <tr>
                  <th scope="col">Item</th>
                  <th scope="col">Qtde</th>
                  <th scope="col">Unitário</th>
                  <th scope="col">Total</th>
                  <th scope="col"></th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let pedidoItem of pedido.itens">
                  <th scope="row">
                    <div class="media align-items-center">
                      <a href="javascript:void(0)" class="avatar rounded-circle mr-3">
                        <img [alt]="pedidoItem.item.descricao" [src]="pedidoItem.item.foto">
                      </a>
                      <div class="media-body">
                        <span class="mb-0 text-sm">{{ pedidoItem.item.descricao }}</span>
                      </div>
                    </div>
                  </th>
                  <td>
                    <p-spinner [(ngModel)]="pedidoItem.quantidade" [min]="1"></p-spinner>
                  </td>
                  <td>
                    <h5>R$ {{ pedidoItem.precoUnitario }}</h5>
                  </td>
                  <td>
                    <h5>R$ {{ pedidoItem.precoTotal }}</h5>
                  </td>
                  <td class="text-right">
                    <button
                      type="button"
                      class="btn btn-outline-secondary"
                      title="Remover"
                      (click)="remover(pedidoItem.item)"
                      ngbTooltip="Remover">
                      <i class="fa fa-trash"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
              <tfoot [hidden]="!pedido.itens.length">
                <tr>
                  <td colspan="5" center>
                    <h5 class="h3">Carrinho vazio</h5>
                    <div class="h5 font-weight-300">
                      Adicione produtos ou serviços utilizando a busca acima
                    </div>
                  </td>
                </tr>
              </tfoot>
            </table>
          </div>
          <div class="card-footer py-4">
          </div>
        </div>
      </div><!-- col-sm-8 -->

      <div class="col-sm-4 col-12">
        <div class="row py-4">
          <div class="tab-pane tab-example-result fade show active" role="tabpanel" aria-labelledby="card-contact-component-tab">
            <div class="card">
              <div class="card-body">
                <div class="row align-items-center">
                  <div class="col-auto">
                    <a href="#" class="avatar avatar-xl rounded-circle">
                      <img [alt]="pedido.cliente.nome" [src]="pedido.cliente.foto">
                    </a>
                  </div>
                  <div class="col ml--2">
                    <h4 class="mb-0">
                      <a href="#!">{{ pedido.cliente.nome }}</a>
                    </h4>
                    <p class="text-sm text-muted mb-0">{{ pedido.cliente.email }}</p>
                    <p class="text-sm text-muted mb-0">{{ pedido.cliente.endereco }}</p>
                    <p class="text-sm text-muted mb-0">{{ pedido.cliente.bairro }}, {{ pedido.cliente.cidade }} - {{ pedido.cliente.estado.descricao }}</p>

                    <div class="avatar-group">
                      <a *ngFor="let pet of pedido.cliente.pets"
                        href="javascript:void(0)"
                        class="avatar avatar-sm"
                        [ngbTooltip]="pet.nome">
                        <img [alt]="pet.nome" [src]="pet.foto" class="rounded-circle">
                      </a>
                    </div>
                  </div>
                  <div class="col-auto">
                    <button type="button" class="btn btn-sm btn-primary">Remover</button>
                  </div>
                </div>
              </div>
            </div><!-- card -->
          </div><!-- tab-pane -->

          <div class="tab-pane tab-example-result fade show active" role="tabpanel" aria-labelledby="card-stats-component-tab">
            <div class="card card-stats">
              <div class="card-body">
                <div class="row">
                  <div class="col">
                    <h5 class="card-title text-uppercase text-muted mb-0">Total</h5>
                    <span class="h2 font-weight-bold mb-0">{{ pedido.total | currency: 'BRL' }}</span>
                  </div>
                  <div class="col-auto">
                    <div class="icon icon-shape bg-red text-white rounded-circle shadow">
                      <i class="ni ni-active-40"></i>
                    </div>
                  </div>
                </div>
                <p class="mt-3 mb-0 text-sm" [hidden]="!pedido.patazBonusTotal">
                  <span class="text-success mr-2"><i class="fa fa-arrow-up"></i> {{ pedido.patazBonusTotal }}</span>
                  <span class="text-nowrap">Pataz acumulados</span>
                </p>
              </div>
            </div>
          </div><!-- tab-pane -->
        </div><!--row-->
      </div><!-- col-sm-4 -->
    </div>
    <div class="row">
      <div class="col-12">
        <div class="tab-pane tab-example-result fade show active" role="tabpanel" aria-labelledby="card-stats-component-tab">
          <div class="card-columns">
            <label *ngFor="let pagamento of pagamentos" [for]="pagamento.id" class="card card-stats">
              <div class="card-body">
                <div class="row">
                  <div class="col">
                    <span class="h2 font-weight-bold mb-0">{{ pedido.total }}</span>
                  </div>
                  <div class="col-auto">
                    <div class="icon icon-shape bg-red text-white rounded-circle shadow">
                      <i class="ni ni-active-40"></i>
                    </div>
                  </div>
                </div>
              </div>
              <input
                [id]="pagamento.id"
                type="radio"
                name="pagamento"
                [value]="pagamento"
                [(ngModel)]="pedido.pagamento">
            </label>
          </div>
        </div>
      </div>

      <button type="submit" class="btn btn-xs btn-primary">Finalizar</button>
    </div>
  </div>  
</form>